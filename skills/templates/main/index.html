{% extends "base.html" %}

{% block content %}
<!-- SEARCH BAR -->
<div class="search-bar">
	<center>
	<form name="myform" method="GET" action="{% url 'search' %}">
		<input class="search-field" name="search" type="text" placeholder="Search" />
	</form>
	</center>
</div>
<!-- END SEARCH BAR -->
<!-- CONTENT SECTION -->
<div class="content-body">
	{% if user.is_authenticated %}
	<!-- JOB ENTRIES SECTION -->
	<div class="filters-menu">
		<h2>Filters</h2>
			<br /><br />
			Location
			<br /><br />
			Salary
			<br /><br />
			Company
		</div>
	<div class="entry-display">
		<div class="sort-menu">
			<p>Showing {{ num_jobs }} results</p>
			<div class="sort-wrapper">
				<form action="{% url 'home' %}" method="get">
					<label for="sort-by">Sort By:</label>
				<select class="sort-button" name="sort-by">
					<option value="match">Match</option>
					<option value="date_created">Post Date</option>
				</select>
					<input type="submit" value="sort" />
				</form>
				<form action="{% url 'home' %}" method="get">
					<label for="match-filter">Match Cutoff:</label>
				<select class="sort-button" name="match-filter">
					<option value="100">100%</option>
					<option value="75">75%</option>
					<option value="50">50%</option>
					<option value="25">25%</option>
				</select>
					<input type="submit" value="filter"/>
				</form>
			</div>
		</div>
		<div class="entries-wrapper">
			{% load app_filters %}
			{% for job in jobs.all %}
			<div class="entry">
				<div class="entry-header">
					<div><h5 id="entry-match" style="color: {{ job.match|get_match_color }}">{{ job.get_total_match }}% match</h5></div>
					<h2 id="entry-title">{{ job.title|title }}</h2><h3 id="entry-company"> with {{ job.co_name }}</h3>
					<h4 id="entry-salary">at ${{ job.low_salary }}k - ${{ job.high_salary}}k per year</h4>
					<p class="date-posted">{{ job.date_created|get_days_old_string }}</p>
				</div>
				<div class="entry-expand">
					<div class="entry-day">
						<h4>Typical Day</h4>
						<p>{{ job.typical_day }}</p>
						<br /><br />
						<p>{{ job.avg_day }}</p>
					</div>
					<div class="entry-tech">
						<h4>Tech Used</h4>
						<p>{{ job.tech_used }}</p>
					</div>
					<div class="entry-skills">
						<h4>Skills Used</h4>
						{% for skill in job.skills.all %}
						<p>
						{{ skill|get_skill_match:user }}% - <b>{{ skill.length }} months</b> of <b>{{ skill.title }}</b>
						</p>
						<br /><br />
						{% endfor %}
					</div>
					<div class="benefits">
						<h4>Benefits</h4>
						{% for ben in job.benefit.all %}
						<p>{{ ben.title|title }}</p>
						<br />
						{% endfor %}
					</div>
				</div>
			</div>
			{% endfor %}
		</div>
	</div>
{% else %}
<h2>Please <a href="{% url 'users:login' %}">log in</a> to view jobs</h2>
{% endif %}
</div>
{% endblock content %}
